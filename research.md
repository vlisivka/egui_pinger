

# Дослідження: Захист VPN від аналізу трафіку через пінги

## Тема дослідження
Методи захисту VPN-тунелів від деанонімізації та аналізу трафіку (Traffic Analysis), що базуються на періодичних ICMP-запитах (пінгах).

## Мета
З'ясувати ризики тривалого пінгування одного хоста через VPN та знайти методи маскування цієї активності для захисту приватності користувача.

## Аналіз загрози
Навіть при сильному шифруванні (AES-256, ChaCha20), метадані трафіку залишаються видимими для спостерігача (провайдера, власника мережі):
1.  **Таймінг (Timing Attacks)**: Якщо програма відправляє пакет кожної секунди точно, спостерігач бачить сплеск трафіку в тунелі з частотою 1 Гц. Це створює "відбиток" (fingerprint).
2.  **Кореляція (Correlation Attacks)**: Зловмисник може порівняти таймінги пакетів на вході у VPN та на виході (на цільовому хості), щоб підтвердити, що конкретний користувач спілкується з конкретним сервером.
3.  **Розмір (Size analysis)**: ICMP-пакети мають стандартний розмір (наприклад, 84 байти з заголовками). Навіть у зашифрованому вигляді вони створюють кадри однакового розміру.

## Опис варіантів захисту

### 1. Випадкова затримка (Jitter)
Це найпростіший та найефективніший метод на рівні клієнта.
-   **Механізм**: Замість фіксованого інтервалу (наприклад, 1.00с) використовувати випадковий (наприклад, 1.00с ± 300мс).
-   **Ефект**: Руйнує математичну періодичність, що робить автоматичне виявлення патернів значно складнішим.
-   **Реалізація**: Вже інтегровано в `logic/pinger.rs` для деяких режимів.

### 2. Варіативність розміру пакета (Packet Padding)
Додавання випадкової кількості даних до "тіла" ICMP-пакета.
-   **Механізм**: Відправляти не стандартні 32/64 байти, а випадкову кількість від 16 до 1024 байт.
-   **Ефект**: Ускладнює фільтрацію за розміром пакета. Спостерігачеві важче відрізнити пінг від короткого запиту до API або DNS.

### 3. Тунелювання через обфусцировані протоколи
Використання додаткового шару маскування.
-   **Механізм**: Використання Cloak, ShadowSocks або V2Ray (VMess), які маскують трафік під звичайний HTTPS (TLS) або випадковий потік байтів.
-   **Ефект**: Пакет виглядає як частина звичайного веб-серфінгу.

### 4. Фоновий шум (Dummy Traffic)
Надсилання фіктивного трафіку паралельно з пінг-запитами.
-   **Механізм**: Програма або система періодично завантажує випадкові дані.
-   **Ефект**: Реальні пінги "губляться" в іншому трафіку.

## Рекомендації для проєкту
1.  **Поглиблений Jitter**: Впровадити обов'язковий джиттер (мінімум 10-15%) для всіх режимів, окрім "Дуже швидко", де швидкість є критичною.
2.  **Налаштування Padding**: Додати в конфігурацію хоста можливість вказати розмір пакета або увімкнути режим "Випадкового розміру" (наприклад, від 32 до 128 байт).
3.  **Порада користувачеві**: При роботі через VPN в недружніх мережах використовувати протоколи з обфускацією (наприклад, AmneziaWG або OpenVPN з Scramble).

## Вплив на проєкт
-   **model/status.rs**: Додати поле `packet_size` та `use_random_padding` до `HostInfo`.
-   **logic/pinger.rs**: Модифікувати створення ICMP-пакета для підтримки кастомного розміру.
-   **logic/pinger.rs**: Додати джиттер до всіх режимів.
