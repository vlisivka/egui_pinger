# Дослідження: Тестування GUI для egui_pinger

## Мета
Визначити найбільш ефективні підходи та інструменти для тестування графічного інтерфейсу (GUI), побудованого на базі бібліотеки `egui` у Rust.

## Опис варіантів

### 1. Відокремлення логіки від UI (Логічне тестування)
Це фундаментальний підхід, де бізнес-логіка (розрахунок jitter, обробка відповідей пінгів, агрегація даних) виноситься в окремі модулі або структури, які не залежать від `egui`.
- **Переваги**: Швидкість, надійність, не потребує спеціальних інструментів для GUI.
- **Недоліки**: Не перевіряє безпосередньо взаємодію користувача з інтерфейсом (наприклад, чи натискається кнопка, чи очищуються поля введення).

### 2. Використання `egui_kittest` (Інтерактивне тестування)
Це сучасний рекомендований підхід для `egui`. Бібліотека побудована на базі `AccessKit` і дозволяє створювати віртуальне середовище ("Harness") для додатку.
- **Можливості**:
  - Емуляція кліків, введення тексту, фокусування.
  - Пошук елементів за мітками (labels) або ідентифікаторами.
  - Перевірка стану UI без рендерингу графіки.
- **Переваги**: Висока швидкість (не потребує GPU/вікна), хороша інтеграція з екосистемою `egui`.

### 3. Тестування знімками екрана (Snapshot/Screenshot Testing)
Використання бібліотек на кшталт `egui_kittest` (з фічею `snapshot`) або `egui-screenshot-testing`. Програма рендерить поточний стан додатку в зображення і порівнює його з еталонним ("golden image").
- **Переваги**: Виявляє візуальні регресії (зсуви пікселів, неправильні кольори, проблеми зі шрифтами).
- **Недоліки**: Чутливість до змін платформи/драйверів, великий об'єм артефактів (зображень) у репозиторії, складність оновлення.

## Рекомендації
Для `egui_pinger` я рекомендую комбінований підхід:
1. **Пріоритет (Етап 1)**: Використовувати **`egui_kittest`** для автоматизації перевірки функціоналу UI (додавання хостів, перемикання режимів). Це забезпечить якісну перевірку "користувацьких сценаріїв" без накладних витрат на графіку.
2. **Основа (Постійно)**: Максимальне покриття юніт-тестами структури `HostStatus` та логіки розрахунку метрик у `src/main.rs` (або в нових модулях).
3. **Візуальний контроль (Етап 2)**: Додати snapshot-тести лише для критичних елементів графіки (History Sparklines), щоб гарантувати коректність відображення графіків.

## Вплив на проєкт
- **Файли**: Буде додано каталог `tests/` з інтеграційними тестами.
- **Cargo.toml**: Додавання `egui_kittest` у `[dev-dependencies]`.
- **src/main.rs**: Потребує невеликого рефакторингу для того, щоб структуру додатка (`EguiPinger`) можна було легко ініціалізувати в тестовому гайді без запуску реального вікна `eframe`.
